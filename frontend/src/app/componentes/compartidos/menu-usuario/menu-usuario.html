<button
  #botonToggle
  class="menu-usuario__boton"
  type="button"
  (click)="toggleMenu()"
  [attr.aria-expanded]="desplegableAbierto()"
  aria-haspopup="true"
  [attr.aria-label]="desplegableAbierto() ? 'Cerrar menú de tu cuenta' : 'Abrir menú de tu cuenta'">
  @if (avatarUsuario()) {
    <img 
      [src]="avatarUsuario()" 
      [alt]="'Tu foto de perfil'"
      class="menu-usuario__avatar"
      decoding="async"
    />
  } @else {
    <app-icono nombre="user-circle" />
  }
  <span class="menu-usuario__nombre">{{ usuario()?.nombreUsuario || 'Usuario' }}</span>
  <app-icono 
    nombre="chevron-down" 
    [class.menu-usuario__icono--rotado]="desplegableAbierto()"
    tamano="sm"
  />
</button>

@if (desplegableAbierto()) {
  <nav
    #menuDropdown
    class="menu-usuario__desplegable"
    role="menu"
    aria-label="Menú de opciones de tu cuenta">
    <button
      class="menu-usuario__opcion"
      type="button"
      role="menuitem"
      aria-label="Ir a tu perfil de usuario"
      (click)="navegarAPerfil()">
      <app-icono nombre="user" />
      <span>Perfil</span>
    </button>

    <button
      class="menu-usuario__opcion"
      type="button"
      role="menuitem"
      aria-label="Ir a configuración de tu cuenta"
      (click)="navegarAConfiguracion()">
      <app-icono nombre="settings" />
      <span>Configuración</span>
    </button>

    <button
      class="menu-usuario__opcion"
      type="button"
      role="menuitem"
      aria-label="Consejos fitness"
      (click)="navegarAConsejos()">
      <app-icono nombre="star" />
      <span>Consejos</span>
    </button>

    <hr class="menu-usuario__separador" aria-hidden="true" />

    <button
      class="menu-usuario__opcion"
      type="button"
      role="menuitem"
      aria-label="Cerrar tu sesión actual"
      (click)="cerrarSesion()">
      <app-icono nombre="log-out" />
      <span>Cerrar sesión</span>
    </button>
  </nav>
}
