<article class="inicio">
  @if (estaAutenticado()) {
    <header class="inicio__bienvenida">
      <h1 class="inicio__saludo">
        ¡Hola <span class="inicio__nombre">{{ nombreUsuario() }}</span>!
      </h1>
      <p class="inicio__mensaje">Bienvenido de nuevo a Gymunity</p>
    </header>
  } @else {
    <app-seccion-bienvenida
      [tituloLineas]="['Encuentra el gimnasio perfecto para ti,', 'según tu estilo y tus metas.']"
      [subtituloLineas]="['Tu entrenamiento comienza aquí.', 'Nosotros te ayudamos a dar el primer paso.']"
      textoBoton="Únete gratis"
      (accion)="abrirRegistro()">
    </app-seccion-bienvenida>
  }

  @if (cargando()) {
    <section class="gimnasios-section gimnasios-section--cargando">
      <p>Cargando gimnasios...</p>
    </section>
  } @else if (error()) {
    <section class="gimnasios-section gimnasios-section--error">
      <p>{{ error() }}</p>
    </section>
  } @else {
    @if (estaAutenticado() && ciudadUsuario()) {
      <section class="gimnasios-section">
        <header class="section-header">
          <a class="section-link" routerLink="/busqueda" [queryParams]="{ciudad: ciudadUsuario()}">
            <h2 class="section-title">Gimnasios cercanos a <strong>{{ ciudadUsuario() }}</strong></h2>
            <span class="section-arrow">›</span>
          </a>
        </header>
        @if (cargandoCercanos()) {
          <p class="gimnasios-section__cargando">Cargando gimnasios...</p>
        } @else if (gimnasiosCercanos().length > 0) {
          <ul class="gimnasios-grid">
            @for (gym of gimnasiosCercanos(); track trackByGimnasioId($index, gym)) {
              <li>
                <app-card
                  [id]="gym.id"
                  [title]="gym.nombre"
                  [subtitle]="gym.disciplinas"
                  [location]="gym.ciudad"
                  [valoracion]="gym.valoracionMedia"
                  [totalResenias]="gym.totalResenias"
                  [imageSrc]="gym.foto"
                  [priority]="$index < 2"
                  variant="vertical"
                />
              </li>
            }
          </ul>
        } @else {
          <p class="gimnasios-section__vacio">
            Aún no hay gimnasios en {{ ciudadUsuario() }}. ¡Pronto habrá más!
          </p>
        }
      </section>
    }

    <section class="gimnasios-section">
      <header class="section-header">
        <a class="section-link" routerLink="/busqueda" [queryParams]="{orden: 'popular'}">
          <h2 class="section-title">Gimnasios más populares</h2>
          <span class="section-arrow">›</span>
        </a>
      </header>
      <ul class="gimnasios-grid">
        @for (gym of gimnasiosPopulares(); track trackByGimnasioId($index, gym)) {
          <li>
            <app-card
              [id]="gym.id"
              [title]="gym.nombre"
              [subtitle]="gym.disciplinas"
              [location]="gym.ciudad"
              [valoracion]="gym.valoracionMedia"
              [totalResenias]="gym.totalResenias"
              [imageSrc]="gym.foto"
              [priority]="$index < 2"
              variant="vertical"
            />
          </li>
        }
      </ul>
    </section>

    <section class="gimnasios-section">
      <header class="section-header">
        <a class="section-link" routerLink="/busqueda" [queryParams]="{orden: 'reciente'}">
          <h2 class="section-title">Nuevos gimnasios en Gymunity</h2>
          <span class="section-arrow">›</span>
        </a>
      </header>
      <ul class="gimnasios-grid">
        @for (gym of gimnasiosRecientes(); track trackByGimnasioId($index, gym)) {
          <li>
            <app-card
              [id]="gym.id"
              [title]="gym.nombre"
              [subtitle]="gym.disciplinas"
              [location]="gym.ciudad"
              [valoracion]="gym.valoracionMedia"
              [totalResenias]="gym.totalResenias"
              [imageSrc]="gym.foto"
              variant="vertical"
            />
          </li>
        }
      </ul>
    </section>
  }
</article>
